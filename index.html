<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Analítica -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DM1M9GM27Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-DM1M9GM27Z', { 'anonymize_ip': true });
  </script>

  <!-- Axeptio Cookies -->
  <script>
    window.axeptioSettings = { clientId: "69055200683c996cd378866f", cookiesVersion: "Spain GDPR Spanish Cookies" };
    (function(d,s){
      var t=d.getElementsByTagName(s)[0], e=d.createElement(s);
      e.async=true; e.src="https://static.axept.io/sdk.js";
      t.parentNode.insertBefore(e,t);
    })(document,"script");
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="index,follow" />
  <meta http-equiv="x-ua-compatible" content="IE=edge" />

  <title>Temotiva | Bienestar emocional en tu día a día</title>
  <meta name="description" content="Temotiva es una app de bienestar emocional que te guía con pasos concretos cuando te sientes sobrepasad@ y no sabes qué hacer. Autocuidado y regulación emocional en tu día a día.">
  <meta name="keywords" content="app bienestar emocional, bienestar emocional, salud mental cotidiana, autocuidado, autocuidado diario, regulación emocional, estrés, ansiedad leve, saturación, hábitos saludables, psicología aplicada">

  <!-- Open Graph y Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="TEMOTIVA | App de bienestar emocional para tu día a día">
  <meta property="og:description" content="Una app de bienestar emocional que te ayuda a saber qué hacer cuando te sientes mal, con pasos concretos de autocuidado y regulación emocional.">
  <meta property="og:image" content="https://www.temotiva.com/logo-temotiva.png">
  <meta property="og:url" content="https://www.temotiva.com/">
  <meta property="og:locale" content="es_ES">
  <meta name="twitter:card" content="summary_large_image">

  <link rel="canonical" href="https://www.temotiva.com/">

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#F7F7F7" id="meta-theme">
  <meta name="application-name" content="TEMOTIVA">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="TEMOTIVA">
  <meta name="color-scheme" content="light">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">

  <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

  <!-- Idiomas SEO -->
  <link rel="alternate" href="https://www.temotiva.com/" hreflang="es">
  <link rel="alternate" href="https://www.temotiva.com/?lang=en" hreflang="en">
  <link rel="alternate" href="https://www.temotiva.com/" hreflang="x-default">

  <!-- Rendimiento -->
  <link rel="preload" href="/style.css" as="style">
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/style-index.css">
  <link rel="preconnect" href="https://static.axept.io" crossorigin>
  <link rel="preconnect" href="https://ejhzxwnhqvcqjqxnuvya.supabase.co" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://formspree.io" crossorigin>
  <link rel="prerender" href="/">
  <link rel="prefetch" href="/blog/" as="document">
  <link rel="prefetch" href="/recursos.html" as="document">

  <!-- Datos estructurados base -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Temotiva",
    "alternateName": "Temotiva bienestar emocional",
    "url": "https://www.temotiva.com/",
    "inLanguage": "es",
    "description": "Temotiva es una app de bienestar emocional que convierte la psicología basada en evidencia en pasos concretos de autocuidado para la vida cotidiana.",
    "publisher": {
      "@type": "Organization",
      "name": "Temotiva LAB",
      "url": "https://www.temotiva.com/"
    }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Temotiva LAB",
    "url": "https://www.temotiva.com/",
    "logo": "https://www.temotiva.com/logo-temotiva.png",
    "description": "Temotiva LAB impulsa Temotiva, una app de bienestar emocional centrada en el autocuidado cotidiano y la regulación emocional basada en psicología.",
    "parentOrganization": {
      "@type": "Organization",
      "name": "Cognitiva Tech Lab",
      "url": "https://www.temotiva.com/ctl.html"
    },
    "sameAs": []
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Inicio",
        "item": "https://www.temotiva.com/"
      }
    ]
  }
  </script>

  <!-- Google Translate -->
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement(
        {
          pageLanguage: 'es',
          includedLanguages: 'es,en,fr,it,pt,de',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        },
        'google_translate_element'
      );
    }
  </script>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
    (function () {
      try {
        var search = window.location.search || "";
        var hash = window.location.hash || "";

        var params = new URLSearchParams(search);
        var hashParams = new URLSearchParams(
          hash && hash.startsWith("#") ? hash.slice(1) : hash
        );

        var isRecovery =
          params.get("type") === "recovery" ||
          hashParams.get("type") === "recovery";

        if (!isRecovery) return;

        var url = new URL(window.location.origin + "/reset.html");

        ["token", "type", "redirect_to", "code", "access_token", "refresh_token"]
          .forEach(function (key) {
            if (params.has(key)) {
              url.searchParams.set(key, params.get(key));
            }
            if (!url.searchParams.has(key) && hashParams.has(key)) {
              url.searchParams.set(key, hashParams.get(key));
            }
          });

        window.location.replace(url.toString());
      } catch (e) {
        console.warn("No se pudo redirigir a reset.html", e);
      }
    })();
  </script>


  
</head>
<body>
  <a href="#app" class="skip-link">Saltar al contenido principal</a>
  <noscript>
    <div style="padding:12px;text-align:center;background:#fff4cd;color:#7a5d00">
      Activa JavaScript para usar TEMOTIVA.
    </div>
  </noscript>

  <!-- Overlay -->
  <div id="overlay" class="overlay" aria-hidden="true"></div>

   <!-- Header -->
  <header class="site-header" id="siteHeader" role="banner">
    <div class="container nav">

      <!-- Logo -->
      <a href="https://www.temotiva.com" class="logo" aria-label="Ir a inicio">
        <img src="/logo-temotiva.png" alt="Logo TEMOTIVA" width="36" height="36">
        <span>TEMOTIVA</span>
      </a>

      <!-- Menú principal -->
      <nav id="mainNav" class="nav-links" aria-label="Menú principal">
        <a href="/demo.html">App</a>
        <a href="/particular.html">Talleres</a>
        <a href="/organizacion.html">Organizaciones</a>
        <a href="/recursos.html">Recursos</a>
        <a href="/blog/">Blog</a>
        <a href="/temotiva-lab.html">Lab</a>
        <a href="/ctl.html">CTL</a>
       <a href="/contacto.html"><strong>Mi cuenta</strong></a>
      </nav>

      <!-- Acciones header -->
      <div class="header-actions" role="group" aria-label="Acciones" style="display:flex;align-items:center;gap:.6rem;">
        
        <div id="google_translate_element" aria-label="Cambiar idioma"></div>

        <button id="installBtn" class="icon-btn" aria-label="Instalar Temotiva" hidden>
          Instalar
        </button>

        <button id="menuBtn" class="menu-btn icon-btn" aria-label="Abrir menú" aria-controls="sidePanel" aria-expanded="false">
          ☰
        </button>
      </div>

    </div>
  </header>
      

  <!-- Panel lateral -->
  <nav id="sidePanel" class="sidebar" aria-label="Menú lateral" aria-hidden="true">
    <a class="logo-side" href="https://www.temotiva.com">
      <img src="/logo-temotiva.png" alt="" aria-hidden="true" width="32" height="32">
      <span>TEMOTIVA</span>
    </a>

    <ul class="menu-list" role="list">
      <li><a href="/demo.html">App</a></li>
      <li><a href="/particular.html">Talleres</a></li>
      <li><a href="/organizacion.html">Organizaciones</a></li>
      <li><a href="/recursos.html">Recursos</a></li>
      <li><a href="/blog/">Blog</a></li>
      <li><a href="/temotiva-lab.html">Lab</a></li>
      <li><a href="/ctl.html">CTL</a></li>
<li><a href="/contacto.html"><strong>Mi cuenta</strong></a></li>
    </ul>

    <a class="privacy-link" href="/privacidad.html">Privacidad</a>
  </nav>

  <main class="content" id="app" role="main">
    <!-- Hero tech con mockup -->
    <section id="inicio" class="section hero reveal" aria-labelledby="hero-title">
      <div class="container">
        <div class="hero-inner">
          <div class="hero-copy">
            <p class="hero-kicker">Bienestar emocional aumentado</p>
            <h1 id="hero-title" class="hero-title">
              Cuando te sientes sobrepasad@ y necesitas saber qué hacer ahora mismo
            </h1>
            <p class="hero-sub">
              Temotiva es una app de bienestar emocional para personas con mucha carga mental.
              Convierte la psicología basada en evidencia en microprácticas guiadas para esos momentos
              en los que sientes que no puedes más, pero aún tienes que seguir con el día.
            </p>

            <div class="hero-metrics hero-metrics-tech">
  <div class="hero-metric-block">
    <div class="hero-metric-main">5 a 10 min</div>
    <p class="hero-metric-sub">
      Microprácticas reales pensadas para momentos de carga mental alta.
    </p>
  </div>

  <div class="hero-metric-block">
    <div class="hero-metric-main">
      120+ microprácticas · 20 talleres temáticos
    </div>
    <p class="hero-metric-sub">
      Diseñados para actuar en el día a día.
    </p>
  </div>
</div>


            <div class="cta-row">
              <a href="/particular.html" class="btn" data-gtag="cta_particular_click" rel="next">Soy particular</a>
              <a href="/organizacion.html" class="btn secondary" data-gtag="cta_org_click" rel="next">Soy organización</a>
            </div>
          </div>

          <div class="hero-device" aria-hidden="true">
            <div class="hero-device-shell">
              <div class="hero-device-glow"></div>
              <img src="/9_Mockup.png" alt="">
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Newsletter -->
    <section id="newsletter" class="section reveal" aria-labelledby="newsletter-title">
      <div class="container">
        <h2 id="newsletter-title" class="section-title">Recibe novedades de Temotiva</h2>
        <p class="section-text">
          Te avisamos de nuevas microprácticas, recursos y talleres. Máximo 1 o 2 correos al mes.
          Revisa la carpeta de spam unos minutos después y añade nuestro correo a tus contactos.
        </p>

        <div class="newsletter-embed">
          <script async src="https://subscribe-forms.beehiiv.com/embed.js"></script>
          <iframe
  src="https://subscribe-forms.beehiiv.com/dea8c242-bc64-433e-abb1-91773ac60526"
  class="beehiiv-embed"
  data-test-id="beehiiv-embed"
  frameborder="0"
  scrolling="auto"
  style="width:100%;max-width:480px;margin:0 auto;border:0;min-height:380px;display:block;"
  title="Formulario de suscripción a la newsletter de Temotiva">
</iframe>
        </div>
      </div>
    </section>

    <!-- Misión / Dolor -->
    <section id="mision" class="section reveal" aria-labelledby="mission-title">
      <div class="container">
        <h2 id="mission-title" class="section-title">Para esos días en los que todo se hace cuesta arriba</h2>
        <p class="section-text">
          Hay momentos en los que vas en automático, tu cabeza no para y no tienes tiempo ni energía para pensar qué te ayudaría a sentirte mejor.
          Ese espacio intermedio entre “no estoy tan mal” y “no puedo más” es justo donde se sitúa Temotiva, cuando necesitas algo claro y posible, no más exigencias.
        </p>
        <div class="grid grid-cols-3">
          <article class="card">
            <h3>Cambios vitales y ruido mental</h3>
            <p>Reorganizar tu vida, tu trabajo o tus relaciones puede ser agotador. Temotiva te ayuda a parar, escuchar lo que necesitas y dar un paso concreto.</p>
          </article>
          <article class="card">
            <h3>Trabajos que agotan por dentro</h3>
            <p>Si trabajas con personas o bajo mucha demanda, es fácil llegar al final del día sin fuerzas. Aquí encuentras prácticas breves para regularte entre tareas.</p>
          </article>
          <article class="card">
            <h3>Estudios y proyectos que saturan</h3>
            <p>Cuando todo son fechas, entregas y objetivos, tu bienestar queda en segundo plano. Temotiva te recuerda que cuidarte también forma parte del plan.</p>
          </article>
        </div>
      </div>
    </section>

    <!-- Producto -->
    <section id="producto" class="section alt reveal" aria-labelledby="product-title">
      <div class="container">
        <h2 id="product-title" class="section-title">Qué hace la app Temotiva por ti</h2>
        <p class="section-text">
          Temotiva convierte la psicología basada en evidencia en acciones breves y guiadas que puedes usar justo cuando aparece el bloqueo, la rumiación
          o ese “no sé qué hacer ahora mismo”, sin sesiones eternas ni pantallas infinitas.
        </p>

        <div class="grid grid-cols-3" role="list">
          <article class="card" role="listitem">
            <h3>Te guía cuando no sabes qué hacer con lo que sientes</h3>
            <p>Pequeñas rutas de autoexploración y regulación emocional que te acompañan paso a paso, para pasar del bloqueo y la rumiación a una acción posible aquí y ahora.</p>
          </article>
          <article class="card" role="listitem">
            <h3>Hace que el autocuidado sea posible en tu día real</h3>
            <p>Acciones cortas y realistas, que puedes integrar incluso en días llenos. Mejor un pequeño gesto sostenible que una lista de pendientes infinita.</p>
          </article>
          <article class="card" role="listitem">
            <h3>Te ayuda a entender tus patrones emocionales</h3>
            <p>Chequeos sencillos y reflexiones guiadas para conocer mejor tus picos, tus bajadas y lo que de verdad te ayuda a estar mejor en tu vida cotidiana.</p>
          </article>
        </div>
      </div>
    </section>

    <!-- Ecosistema -->
    <section id="ecosistema" class="section reveal" aria-labelledby="ecosystem-title">
      <div class="container">
        <h2 id="ecosystem-title" class="section-title">Temotiva es más que una app</h2>
        <p class="section-text">
          A partir de la app Temotiva nace un pequeño ecosistema de bienestar emocional: recursos descargables, talleres y propuestas para personas y organizaciones
          que quieren cuidar mejor de su salud emocional en el día a día.
        </p>
        <div class="grid grid-cols-3">
          <article class="card">
            <h3>Recursos</h3>
            <p>Guías, ejercicios y materiales breves de bienestar emocional que podrás ir ampliando en la página de Recursos.</p>
          </article>
          <article class="card">
            <h3>Talleres y actividades</h3>
            <p>Espacios prácticos para trabajar el autocuidado, la regulación emocional y el bienestar cotidiano en grupo.</p>
          </article>
          <article class="card">
            <h3>Para organizaciones</h3>
            <p>Propuestas adaptadas para equipos, centros educativos y proyectos que quieren introducir el bienestar emocional en su día a día.</p>
          </article>
        </div>
      </div>
    </section>

    <!-- Quién impulsa -->
    <section id="impulsa" class="section alt reveal" aria-labelledby="impulsa-title">
      <div class="container">
        <h2 id="impulsa-title" class="section-title">Quién impulsa Temotiva</h2>
        <p class="section-text">
          Temotiva nace en la intersección entre psicología, diseño accesible e innovación social. Detrás del proyecto hay un equipo que cuida tanto el contenido
          como la forma en que se ofrece.
        </p>
        <div class="grid grid-cols-2">
          <article class="card">
            <h3>Temotiva LAB</h3>
            <p>
              El equipo que diseña y experimenta con nuevas formas de llevar la psicología aplicada y el bienestar emocional a la vida cotidiana,
              con un enfoque humano, cercano y accesible.
            </p>
          </article>
          <article class="card">
            <h3>Cognitiva Tech Lab (CTL)</h3>
            <p>
              Una entidad que impulsa proyectos con impacto social y educativo, entre ellos Temotiva, poniendo la tecnología al servicio del cuidado emocional
              y del acceso a recursos de calidad.
            </p>
          </article>
        </div>
      </div>
    </section>

    <!-- Reseñas -->
    <section id="resenas" class="section reviews reveal" aria-labelledby="reviews-title">
      <div class="container">
        <h2 id="reviews-title" class="section-title">Reseñas</h2>
        <p class="frase">Personas que han probado Temotiva.</p>

                <!-- Reseñas reales desde Google (Tagembed) -->
        <div class="tagembed-widget" style="width:100%;height:100%;overflow:auto;" data-widget-id="310452" data-website="1"></div>
        <script src="https://widget.tagembed.com/embed.min.js" type="text/javascript"></script>
        <!-- Fin widget -->

      </div>
    </section>

    <!-- Contacto -->
    <section id="contacto" class="section alt reveal" aria-labelledby="contact-title">
      <div class="container">
        <h2 id="contact-title" class="section-title">Contacto</h2>

        <form id="contactForm" class="form form-pro" novalidate>
          <input type="hidden" name="_subject" value="Nuevo mensaje desde TEMOTIVA">
          <input type="hidden" name="_language" value="es">

          <div class="row">
            <div>
              <label for="cf-nombre">Nombre</label>
              <input id="cf-nombre" type="text" name="nombre" placeholder="Tu nombre" required autocomplete="name">
              <div class="error" id="cf-nombre-error">Indica tu nombre.</div>
            </div>
            <div>
              <label for="cf-email">Correo</label>
              <input id="cf-email" type="email" name="email" placeholder="tu@email.com" required autocomplete="email" inputmode="email">
              <div class="error" id="cf-email-error">Introduce un correo válido.</div>
            </div>
          </div>

          <div class="u-mt">
            <label for="cf-msg">Mensaje</label>
            <textarea id="cf-msg" name="mensaje" rows="4" placeholder="Cómo podemos ayudarte" required></textarea>
            <div class="error" id="cf-msg-error">Cuéntanos brevemente tu consulta.</div>
          </div>

          <div class="u-mt">
            <label class="checkline" for="cf-consent">
              <input id="cf-consent" type="checkbox" name="consent" required>
              <span>Acepto la <a href="/privacidad.html">política de privacidad</a> y el tratamiento de mis datos para responder a mi consulta.</span>
            </label>
          </div>

          <input type="text" name="_gotcha" class="u-hidden" aria-hidden="true" autocomplete="off">

          <div class="u-flex u-gap-s u-mt">
            <button type="submit" class="btn" id="cf-submit" disabled>Enviar</button>
            <small class="hint">Respondemos lo antes posible.</small>
          </div>
        </form>

        <p id="formMsg" class="form-msg u-hidden" style="color:#1a7f37; margin-top:1rem;">
          Gracias, te contactaremos pronto. Si lo deseas, puedes enviar un mensaje a
          <a href="mailto:info@temotiva.com">info@temotiva.com</a>, estaremos encantados de atenderte.
        </p>
      </div>
    </section>

    <!-- Footer -->
    <footer class="site-footer" role="contentinfo">
      <div class="container" style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;">
        <p style="margin:0;">Temotiva® marca registrada desde 2025</p>
        <div class="u-flex u-gap-s" style="align-items:center;">
          <a href="/privacidad.html">Política de privacidad</a>
          <a href="/cookies.html">Política de cookies</a>
          <a href="/aviso-legal.html">Aviso legal</a>
          <a href="#inicio" class="back-top">Volver arriba ↑</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
  <script>
    window.addEventListener("load", function(){
      try {
        var SUPABASE_URL = "https://ejhzxwnhqvcqjqxnuvya.supabase.co";
        var SUPABASE_ANON_KEY = "sb_publishable_8nz_638F1vO2JbkFw9DHSw_AxB179qA";
        var supabase = window.supabase && window.supabase.createClient
          ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
          : null;
        console.log("Conectado a Supabase", !!supabase);
      } catch(e){
        console.warn("Supabase no disponible", e);
      }
    });
  </script>

  <!-- JS base -->
  <script src="/script.js" defer></script>

  <!-- UI, accesibilidad, PWA y mejoras -->
  <script>
    document.documentElement.classList.add('js-ready');
    function $(s){ return document.querySelector(s); }
    function $all(s){ return Array.prototype.slice.call(document.querySelectorAll(s)); }

    /* Header sombra y nav activa por sección */
    var siteHeader = $("#siteHeader");
    var sections = ["newsletter","mision","producto","ecosistema","impulsa","resenas","contacto"]
      .map(function(id){ return document.getElementById(id); })
      .filter(function(el){ return !!el; });
    var navLinks = $all("#mainNav a");

    function setActive(hash){
      navLinks.forEach(function(a){
        var href = a.getAttribute("href");
        var isActive = href === hash || href === (location.pathname + hash);
        a.classList.toggle("active", isActive);
        if(isActive){
          a.setAttribute("aria-current","page");
        } else {
          a.removeAttribute("aria-current");
        }
      });
    }

    function onScrollHeader(){
      var y = window.scrollY || window.pageYOffset || 0;
      if(siteHeader){
        siteHeader.classList.toggle("is-scrolled", y > 8);
      }
    }
    onScrollHeader();
    document.addEventListener("scroll", onScrollHeader, { passive: true });

    if ("IntersectionObserver" in window){
      var ioNav = new IntersectionObserver(function(entries){
        entries.forEach(function(e){
          if (e.isIntersecting){
            setActive("#" + e.target.id);
          }
        });
      }, { threshold: 0.5 });
      sections.forEach(function(s){
        ioNav.observe(s);
      });
    }

    /* Panel lateral accesible */
    var body = document.body;
    var sidebar = $("#sidePanel");
    var overlay = $("#overlay");
    var menuBtn = $("#menuBtn");
    var lastFocus = null;

    function trapFocus(e){
      if(!sidebar) return;
      var focusables = sidebar.querySelectorAll('a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if (!focusables.length) return;
      focusables = Array.prototype.slice.call(focusables);
      var first = focusables[0];
      var last = focusables[focusables.length - 1];
      if (e.key === "Tab"){
        if (e.shiftKey && document.activeElement === first){
          last.focus();
          e.preventDefault();
        } else if (!e.shiftKey && document.activeElement === last){
          first.focus();
          e.preventDefault();
        }
      }
    }

    function openSidebar(){
      if(!sidebar || !overlay) return;
      lastFocus = document.activeElement;
      sidebar.classList.add("is-open");
      sidebar.setAttribute("aria-hidden","false");
      overlay.classList.add("show");
      body.style.overflow = "hidden";
      if(menuBtn){
        menuBtn.setAttribute("aria-expanded","true");
      }
      var first = sidebar.querySelector("a, button, input, select, textarea");
      if(first){ first.focus(); }
      sidebar.addEventListener("keydown", trapFocus);
    }

    function closeSidebar(){
      if(!sidebar || !overlay) return;
      sidebar.classList.remove("is-open");
      sidebar.setAttribute("aria-hidden","true");
      overlay.classList.remove("show");
      body.style.overflow = "";
      if(menuBtn){
        menuBtn.setAttribute("aria-expanded","false");
      }
      sidebar.removeEventListener("keydown", trapFocus);
      if(lastFocus && lastFocus.focus){
        lastFocus.focus();
      }
    }

    if(menuBtn){
      menuBtn.addEventListener("click", function(){
        if (sidebar && sidebar.classList.contains("is-open")){
          closeSidebar();
        } else {
          openSidebar();
        }
      });
    }
    if(overlay){
      overlay.addEventListener("click", closeSidebar);
    }
    document.addEventListener("keydown", function(e){
      if(e.key === "Escape"){
        closeSidebar();
      }
    });

    /* Reveal con IO */
    (function(){
      var items = $all(".reveal");
      if(!("IntersectionObserver" in window)){
        items.forEach(function(el){ el.classList.add("visible"); });
        return;
      }
      var io = new IntersectionObserver(function(entries){
        entries.forEach(function(e){
          if(e.isIntersecting){
            e.target.classList.add("visible");
            io.unobserve(e.target);
          }
        });
      }, { threshold: 0.12, rootMargin: "0px 0px -8% 0px" });
      items.forEach(function(el){ io.observe(el); });
    })();

    /* Service Worker */
    if("serviceWorker" in navigator){
      window.addEventListener("load", function(){
        navigator.serviceWorker.register("/pwabuilder-sw.js", { scope: "/" })
          .then(function(reg){ console.log("Service Worker activo:", reg.scope); })
          .catch(function(err){ console.error("Fallo al registrar el SW:", err); });
      });
    }

    /* Contacto: validación, consentimiento y envío con reintento */
    (function(){
      var form = document.getElementById('contactForm');
      var okMsg = document.getElementById('formMsg');
      if(!form) return;
      var nombre = document.getElementById('cf-nombre');
      var email = document.getElementById('cf-email');
      var msg = document.getElementById('cf-msg');
      var eNombre = document.getElementById('cf-nombre-error');
      var eEmail = document.getElementById('cf-email-error');
      var eMsg = document.getElementById('cf-msg-error');
      var btn = document.getElementById('cf-submit');
      var consent = document.getElementById('cf-consent');

      function clearErr(input, errorEl){
        if(!input || !errorEl) return;
        input.addEventListener('input', function(){
          input.setCustomValidity('');
          errorEl.style.display='none';
        });
      }
      clearErr(nombre, eNombre);
      clearErr(email, eEmail);
      clearErr(msg, eMsg);

      function toggle(){
        if(!btn || !consent) return;
        btn.disabled = !consent.checked;
      }
      if(consent){
        consent.addEventListener('change', toggle);
      }
      toggle();

      async function postWithRetry(url, body){
        var ctrl = null;
        var t = null;
        var options = {
          method:'POST',
          headers:{Accept:'application/json'},
          body: body
        };

        if (window.AbortController){
          ctrl = new AbortController();
          options.signal = ctrl.signal;
          t = setTimeout(function(){ ctrl.abort(); }, 8000);
        }

        try{
          var r = await fetch(url, options);
          if(t){ clearTimeout(t); }
          if(r.ok) return true;
        }catch(e){}

        try{
          var r2 = await fetch(url, {
            method:'POST',
            headers:{Accept:'application/json'},
            body: body
          });
          return r2.ok;
        }catch(e2){
          return false;
        }
      }

      form.addEventListener('submit', function(e){
        e.preventDefault();

        var valid = true;
        if(!nombre || !email || !msg){ return; }

        if(!nombre.value.trim()){
          valid=false;
          nombre.setCustomValidity('Requerido');
          if(eNombre){ eNombre.style.display='block'; }
        }
        if(!email.checkValidity()){
          valid=false;
          email.setCustomValidity('Correo no válido');
          if(eEmail){ eEmail.style.display='block'; }
        }
        if(!msg.value.trim()){
          valid=false;
          msg.setCustomValidity('Requerido');
          if(eMsg){ eMsg.style.display='block'; }
        }
        if(!valid){
          [nombre,email,msg].forEach(function(el){
            if(el && el.reportValidity){ el.reportValidity(); }
          });
          return;
        }

        if(btn){ btn.disabled = true; }
        postWithRetry("https://formspree.io/f/xnnobrvn", new FormData(form)).then(function(ok){
          if(btn){ btn.disabled = false; }
          if(ok){
            form.reset();
            if(okMsg){
              okMsg.classList.remove('u-hidden');
            }
          } else {
            alert("No se pudo enviar, intenta de nuevo más tarde.");
          }
        });
      });
    })();

    /* PWA install banner */
    var INSTALL_KEY = "temotiva-install-dismissed";
    var VISITS_KEY = "temotiva-visit-count";
    var deferredPrompt = null;
    try {
      var v = parseInt(localStorage.getItem(VISITS_KEY) || "0", 10) + 1;
      localStorage.setItem(VISITS_KEY, String(v));
    } catch(e){}

    var installBtn = $("#installBtn");
    var banner = $("#pwaBanner");
    var installNow = $("#pwaInstallNow");
    var installLater = $("#pwaInstallLater");

    window.addEventListener("beforeinstallprompt", function(e){
      e.preventDefault();
      deferredPrompt = e;
      if(installBtn){
        installBtn.hidden = false;
      }

      var dismissed = false;
      var visits = 0;
      try {
        dismissed = localStorage.getItem(INSTALL_KEY) === "1";
        visits = parseInt(localStorage.getItem(VISITS_KEY) || "0", 10);
      } catch(e2){}

      if (!dismissed && visits >= 3 && banner){
        banner.classList.add("show");
      }
    });

    async function promptInstall(){
      try{
        if(installBtn){
          installBtn.hidden = true;
        }
        if(!deferredPrompt) return;
        await deferredPrompt.prompt();
        var res = await deferredPrompt.userChoice;
        if (!res || res.outcome !== "accepted"){
          if(banner){
            banner.classList.remove("show");
          }
        }
      }catch(e){}
      deferredPrompt = null;
    }

    if(installBtn){
      installBtn.addEventListener("click", function(){
        if(deferredPrompt){
          promptInstall();
        }
      });
    }
    if(installNow){
      installNow.addEventListener("click", function(){
        if(deferredPrompt){
          promptInstall();
        } else if(banner){
          banner.classList.remove("show");
        }
      });
    }
    if(installLater){
      installLater.addEventListener("click", function(ev){
        ev.preventDefault();
        try {
          localStorage.setItem(INSTALL_KEY,"1");
        } catch(e){}
        if(banner){
          banner.classList.remove("show");
        }
      });
    }

    window.addEventListener("appinstalled", function(){
      try {
        localStorage.setItem(INSTALL_KEY, "1");
      } catch(e){}
      if(banner){
        banner.classList.remove("show");
      }
      if(installBtn){
        installBtn.hidden = true;
      }
      console.log("TEMOTIVA instalada");
    });

    var isStandalone = false;
    try {
      isStandalone =
        (window.matchMedia && window.matchMedia("(display-mode: standalone)").matches) ||
        window.navigator.standalone;
    } catch(e){}
    if (isStandalone){
      if(installBtn){
        installBtn.setAttribute("hidden","true");
      }
      if(banner){
        banner.classList.remove("show");
      }
    }

    /* GA para CTAs clave */
    (function(){
      var ctas = document.querySelectorAll('[data-gtag]');
      Array.prototype.forEach.call(ctas, function(b){
        b.addEventListener('click', function(){
          if(typeof gtag === "function"){
            gtag('event', b.dataset.gtag);
          }
        });
      });
    })();

    /* Volver arriba con reduce motion */
    (function(){
      var backTop = document.querySelector('.back-top');
      if(!backTop) return;
      backTop.addEventListener('click', function(e){
        e.preventDefault();
        var prefersReduced = false;
        try {
          prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        } catch(err){}
        window.scrollTo({ top: 0, behavior: prefersReduced ? 'auto' : 'smooth' });
      });
    })();
  </script>

  <!-- Banner de instalación PWA -->
  <div id="pwaBanner" class="pwa-install" role="dialog" aria-live="polite" aria-label="Instalar TEMOTIVA">
    <div class="row">
      <img src="/logo-temotiva.png" alt="" width="28" height="28" style="border-radius:6px">
      <div class="msg">Instala TEMOTIVA para un acceso rápido y uso sin conexión.</div>
      <div class="actions">
        <button id="pwaInstallNow" class="btn" type="button">Instalar</button>
        <button id="pwaInstallLater" class="btn secondary" type="button">Más tarde</button>
      </div>
    </div>
  </div>

  <!-- Eventos GA del banner -->
  <script>
    var btnInstallNow = document.getElementById("pwaInstallNow");
    var btnInstallLater = document.getElementById("pwaInstallLater");

    if(btnInstallNow){
      btnInstallNow.addEventListener("click", function() {
        if(typeof gtag === "function"){
          gtag('event', 'click_instalar', {
            event_category: 'PWA',
            event_label: 'Botón Instalar TEMOTIVA'
          });
        }
      });
    }
    if(btnInstallLater){
      btnInstallLater.addEventListener("click", function() {
        if(typeof gtag === "function"){
          gtag('event', 'click_instalar_mas_tarde', {
            event_category: 'PWA',
            event_label: 'Botón Más tarde'
          });
        }
      });
    }
  </script>
  <script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", function () {
      navigator.serviceWorker
        .register("/sw.js")
        .catch(function (error) {
          console.error("Error al registrar el Service Worker:", error);
        });
    });
  }
</script>
</body>
</html>
