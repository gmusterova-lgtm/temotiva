<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Compartir a TEMOTIVA</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Recepción de contenido compartido hacia TEMOTIVA.">
  <style>
    :root{ --bg:#f9f9f9; --ink:#222; --card:#fff; --soft:#555 }
    @media (prefers-color-scheme: dark){ :root{ --bg:#0f1115; --ink:#eaeaea; --card:#151923; --soft:#bbb } }
    body{ margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,Arial,sans-serif; min-height:100vh; display:grid; place-items:center }
    .wrap{ max-width:640px; background:var(--card); border-radius:14px; padding:24px; box-shadow:0 8px 24px rgba(0,0,0,.08); text-align:center }
    h1{ margin:0 0 6px } p{ margin:8px 0; color:var(--soft) }
    .ok{ color:#1a7f37 } .btn{ display:inline-block; padding:.7rem 1rem; border-radius:10px; background:#000; color:#fff; text-decoration:none }
  </style>
</head>
<body>
  <div class="wrap">
    <img src="/icon-192.png" alt="TEMOTIVA" width="48" height="48" style="border-radius:10px">
    <h1>Contenido recibido</h1>
    <p id="msg">Procesando lo que has compartido…</p>
    <p><a class="btn" href="/inicio.html">Ir al inicio</a></p>
  </div>

  <script>
    // Mínimo viable para cumplir Web Share Target.
    // Navegadores que soportan POST te entregan un form con title, text, url y files.
    (async () => {
      try {
        // Si llega como navegación con datos, intentamos leerlos con Navigation API
        if ('navigation' in window && 'entries' in navigation) {
          const entry = navigation.currentEntry || null;
          // No todos exponen formData aún, pero lo intentamos
          if (entry && entry.getState) {
            // Placeholder por compatibilidad, no todos soportan getState con formData
          }
        }
        // Como fallback, intentamos leer parámetros GET si el SO reenvía por URL
        const qs = new URLSearchParams(location.search);
        const title = qs.get('title');
        const text = qs.get('text');
        const url = qs.get('url');

        const msg = document.getElementById('msg');
        if (title || text || url) {
          msg.innerHTML = '<span class="ok">Compartido:</span><br>' +
            (title ? ('<strong>Título:</strong> ' + title + '<br>') : '') +
            (text ? ('<strong>Texto:</strong> ' + text + '<br>') : '') +
            (url ? ('<strong>URL:</strong> ' + url) : '');
        } else {
          msg.textContent = 'Contenido recibido, redirigiendo…';
        }

        // Redirige al inicio tras un momento
        setTimeout(() => { location.href = '/inicio.html'; }, 1500);
      } catch(e) {
        console.warn('Share Target fallback:', e);
        setTimeout(() => { location.href = '/inicio.html'; }, 1500);
      }
    })();
  </script>
</body>
</html>
